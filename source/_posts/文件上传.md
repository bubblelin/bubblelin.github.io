---
title: 简单实例之文件上传（二），基于Struts2项目中
date: 2016-08-10 00:32:11
categories: 编程
tags: [Java]
---

### 在jsp中
``` bash
<s:form action="template_upload" namespace="/" method="post" enctype="mutipart/form-data">
	<input type="file" name="resource"/>
</s:form>
```

### 在Action中
* 实现下列field的setter方法
``` bash
private File resource;//必须有，名称resource根据jsp中name的一致
private String resourceFileName;//可不用
private String resourceContentType;//可不用
```
* 定义文件上传的执行方法
``` bash
public String upload(){
  this.getFilePath(resource);
  return "upload";
}
```
* 文件上传的具体实现，此处没有使用copy的方式存储上传的文件，而是以renameTo“移动”的方式
``` bash
private String getFilePath(File srcFile) {
  String filePath = null;
  if(resource != null){
    String realPath = ServletActionContext.getServletContext().getRealPath("/upload");
    File dateFile = new File(realPath);
    if(!dateFile.exists()){
      realPath.mkdirs();
    }
    filePath = realPath+UUID.randomUUID().toString()+"."+FilenameUtils.getExtension(srcFile.getName());
    //renameTo移动文件，即上传文件
    File dest = new File(filePath);
    srcFile.renameTo(dest);
  }
  return filePath;
}
```

### 在struts.xml中
``` bash
<result type="upload"></result>
```
